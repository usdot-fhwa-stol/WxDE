<!DOCTYPE html>
<html><head>
    <meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">

    <title>Weather Data Environment - Collector Map Interface</title>

    <!-- Bootstrap3 UI framework -->
    <link href="bootstrap.css" rel="stylesheet">


    <link href="WDEMap.css" rel="stylesheet" type="text/css" media="screen">
    
    <!-- top menu CSS style -->
    <link href="top-mini-nav.css" rel="stylesheet">
    <link href="wxde-mini-style.css" rel="stylesheet">
    <link href="styles/jquery-ui.css" rel="stylesheet">
    <link href="styles/jquery-ui-timepicker-addon.min.css" rel="stylesheet">
	<link rel="stylesheet" href="styles/leaflet.css" />
  
	<script src="js/jquery.js"></script>
  <script src="js/jquery-ui.js"></script>
 
  
	<script src="js/us-states.js"></script>
	<script src="js/leaflet.js"></script>
	<script src="js/jquery-ui-timepicker-addon.min.js"></script>
<script src="js/leaflet-wxde.js"></script> 
  <style>
    
    #layerControlContainer
    {
      margin: 8px 5px 5px;
      float:left;
    }
    
    .ui-datepicker-current
    {
      display:none;
    }
    .leaflet-marker-pane
    {
      z-index: 4;
    }
    .leaflet-overlay-pane
    {
      z-index: 5;
    }
    
    #obstypes
    {
      margin-left:15px;
    }
    
    #LayersMenuContainer
    {
      display:block; 
      float:left; 
      z-index: 10; 
      position:absolute; 
      bottom: 12px;
      display:none;
    }
    
    #map-container
    {
      height:428px; 
      position:relative
    }
    
    #LayersMenu input
    {
      float:right;
    }
  </style>
	
<script type="text/javascript">
  
  var map;
    $( document ).ready(function() {
   
      $.ajax({
        type: "GET",
        url: "ResetSession"
      });
      
       $( "#LayersMenu" ).menu();
  

        var totalNavHeights = $('#top-nav').height() +
                $('#top-tools').height() +
                $('#menu-nav').height() +
                $('#bottom-tools').height();

        var responsiveMap = function (e) {
            $('#map-container').height(
                    12 + $(window).height() - totalNavHeights
            );
        };

        responsiveMap();

        $(window).bind('resize', responsiveMap);

$("#LayersMenu").find("input:checkbox").each(function (i) {
        
        var thisSet = $(this); 
        
        thisSet.parent("li").click(this,function(event)
        {
  //        event.handleObj.data.checked = !event.handleObj.data.checked;
          event.stopPropagation();
        });
        
        
      });


  
    $('#LayersMenuButton').click(function() {
         $('#LayersMenuContainer').slideToggle();
  });
  
  
    
  
    
    
  var statesGroup;
  
  
function setStandardStyleProperties(style)
{
  style.radius = 4;
  style.fillColor = style.color;
  style.color='black';
  style.weight = 1;
  style.opacity = 1;
  style.fillOpacity = 0.8;
  return style;
}
  
  
function setStandardPolylineStyleProperties(style)
{
  style.weight = 5;
  style.opacity = 1;
  style.fillOpacity = 0.8;
  return style;
}



var tileLayer = L.tileLayer('http://localhost:8080/tiles/cache/{z}/{x}/{y}.png', {
  maxZoom: 18,
  attribution: '',
  id: 'mapbox.streets'
});

function onEachFeature(feature, layer)
{
  layer.on({
    mouseover: highlightFeature,
    mouseout: resetHighlight,
    click: zoomToFeature
  });
  function highlightFeature(e)
  {
    var layer = e.target;
    layer.setStyle({
      weight: 5,
      color: '#666',
      dashArray: '',
      fillOpacity: 0.5
    });
    if (!L.Browser.ie && !L.Browser.opera)
    {
      layer.bringToFront();
    }
  }

  function resetHighlight(e)
  {
    statesGroup.resetStyle(e.target);
  }
}
function zoomToFeature(e)
{
  map.fitBounds(e.target.getBounds());
  map.removeLayer(statesGroup);
}



var style = {
    fillColor: 'blue',
    weight: 2,
    opacity: 1,
    color: 'white',
    dashArray: '3'
  };

statesGroup = L.geoJson(statesData, {style: style, onEachFeature: onEachFeature});

  var  dialog = $( "#dialog-form" ).dialog({
      autoOpen: false,
      modal: true,
     // draggable:false,
      width:"auto",
      height:"auto"
      
    });

map = L.wxdeSummaryMap('map_canvas', {
  center: [39.01558, -95.49574],
  attributionControl:false,
  zoom: 4,
  layers: [tileLayer],
  statesLayer: statesGroup,
  stationCodeDiv: document.getElementById('stationCodeValue'),
  latDiv: document.getElementById('latValue'),
  lngDiv: document.getElementById('lngValue'),
  lstObstypes: document.getElementById('obstypes'),
  platformDetailsWindow:
  { 
    dialog:dialog, 
    platformDetailsTable:$('#platform-details'),
    platformObsTable:$('#obs-data')
  },
  selectedTimeFunction : function()
  {
    return $('#datetimepicker').datetimepicker('getDate').getTime();
  },
  useMetricUnitsFunction:function()
  {
    return $("#metricUnits").is(':checked');
  },
  selectedObsTypeFunction : function()
  {
    return $('#obstypes').val();
  }
});

  
var rwisOptions = {checkbox: document.getElementById("chkRwisLayer")};
map.registerWxdeLayer(L.wxdeLayer('RwisLayer', createCircleMarkers, setStandardStyleProperties({ color: "#d819d8"}), rwisOptions));

var mobileOptions = {checkbox: document.getElementById("chkMobileLayer")};
map.registerWxdeLayer(L.wxdeLayer('MobileRwisLayer', createCircleMarkers, setStandardStyleProperties({color: "blue"}), mobileOptions));

var metaDataOptions = {hasObs: false, checkbox: document.getElementById("chkMetaDataLayer")};
var metaDataStyle = setStandardStyleProperties({ color: "grey"});

map.registerWxdeLayer(L.wxdeLayer('MetaDataLayer', createCircleMarkers, metaDataStyle, metaDataOptions));


var roadOptions = {checkbox: document.getElementById("chkRoadLayer")};
map.registerWxdeLayer(L.wxdeLayer('RoadLayer', processPolylineData, setStandardPolylineStyleProperties({ color: "green"}), roadOptions));


var minuteInterval = 20;
var allowTimes = [];
for(var hour = 0; hour< 24; ++hour)
{
  for(var minute = 0; minute <60; minute += minuteInterval)
  {
    allowTimes.push(hour + ':' + minute);
  }
}

var startDate = new Date();
startDate.setMinutes(startDate.getMinutes()- startDate.getMinutes() % minuteInterval);
$('#datetimepicker').datetimepicker(
  {
    stepMinute:20,
    onClose : function()
    {
      //alert('close');
      map.refreshLayers();
    }
  /**  value:startDate, 
    allowTimes: allowTimes**/
});

    $('#obstypes').change(function() {
      map.refreshLayers();
    });
    
    $('input[name="UNIT"]').change(function(){
      map.updateObstypeLabels();
      map.updateObsValueUnits();
    });


    $('#datetimepicker').datetimepicker('setDate', startDate );


//$('#input').datetimepicker('getValue');
  /**
  var dataSet = [
    [ "Tiger Nixon", "System Architect", "Edinburgh", "5421", "2011/04/25", "$320,800" ],
    [ "Garrett Winters", "Accountant", "Tokyo", "8422", "2011/07/25", "$170,750" ],
    [ "Ashton Cox", "Junior Technical Author", "San Francisco", "1562", "2009/01/12", "$86,000" ],
    [ "Cedric Kelly", "Senior Javascript Developer", "Edinburgh", "6224", "2012/03/29", "$433,060" ],
    [ "Airi Satou", "Accountant", "Tokyo", "5407", "2008/11/28", "$162,700" ],
    [ "Brielle Williamson", "Integration Specialist", "New York", "4804", "2012/12/02", "$372,000" ],
    [ "Herrod Chandler", "Sales Assistant", "San Francisco", "9608", "2012/08/06", "$137,500" ],
    [ "Rhona Davidson", "Integration Specialist", "Tokyo", "6200", "2010/10/14", "$327,900" ],
    [ "Colleen Hurst", "Javascript Developer", "San Francisco", "2360", "2009/09/15", "$205,500" ],
    [ "Sonya Frost", "Software Engineer", "Edinburgh", "1667", "2008/12/13", "$103,600" ],
    [ "Jena Gaines", "Office Manager", "London", "3814", "2008/12/19", "$90,560" ],
    [ "Quinn Flynn", "Support Lead", "Edinburgh", "9497", "2013/03/03", "$342,000" ],
    [ "Charde Marshall", "Regional Director", "San Francisco", "6741", "2008/10/16", "$470,600" ],
    [ "Haley Kennedy", "Senior Marketing Designer", "London", "3597", "2012/12/18", "$313,500" ],
    [ "Tatyana Fitzpatrick", "Regional Director", "London", "1965", "2010/03/17", "$385,750" ],
    [ "Michael Silva", "Marketing Designer", "London", "1581", "2012/11/27", "$198,500" ],
    [ "Paul Byrd", "Chief Financial Officer (CFO)", "New York", "3059", "2010/06/09", "$725,000" ],
    [ "Gloria Little", "Systems Administrator", "New York", "1721", "2009/04/10", "$237,500" ],
    [ "Bradley Greer", "Software Engineer", "London", "2558", "2012/10/13", "$132,000" ],
    [ "Dai Rios", "Personnel Lead", "Edinburgh", "2290", "2012/09/26", "$217,500" ],
    [ "Jenette Caldwell", "Development Lead", "New York", "1937", "2011/09/03", "$345,000" ],
    [ "Yuri Berry", "Chief Marketing Officer (CMO)", "New York", "6154", "2009/06/25", "$675,000" ],
    [ "Caesar Vance", "Pre-Sales Support", "New York", "8330", "2011/12/12", "$106,450" ],
    [ "Doris Wilder", "Sales Assistant", "Sidney", "3023", "2010/09/20", "$85,600" ],
    [ "Angelica Ramos", "Chief Executive Officer (CEO)", "London", "5797", "2009/10/09", "$1,200,000" ],
    [ "Gavin Joyce", "Developer", "Edinburgh", "8822", "2010/12/22", "$92,575" ],
    [ "Jennifer Chang", "Regional Director", "Singapore", "9239", "2010/11/14", "$357,650" ],
    [ "Brenden Wagner", "Software Engineer", "San Francisco", "1314", "2011/06/07", "$206,850" ],
    [ "Fiona Green", "Chief Operating Officer (COO)", "San Francisco", "2947", "2010/03/11", "$850,000" ],
    [ "Shou Itou", "Regional Marketing", "Tokyo", "8899", "2011/08/14", "$163,000" ],
    [ "Michelle House", "Integration Specialist", "Sidney", "2769", "2011/06/02", "$95,400" ],
    [ "Suki Burks", "Developer", "London", "6832", "2009/10/22", "$114,500" ],
    [ "Prescott Bartlett", "Technical Author", "London", "3606", "2011/05/07", "$145,000" ],
    [ "Gavin Cortez", "Team Leader", "San Francisco", "2860", "2008/10/26", "$235,500" ],
    [ "Martena Mccray", "Post-Sales support", "Edinburgh", "8240", "2011/03/09", "$324,050" ],
    [ "Unity Butler", "Marketing Designer", "San Francisco", "5384", "2009/12/09", "$85,675" ]
];
 
$(document).ready(function() {
    $('#example').DataTable( {
        data: dataSet,
        columns: [
            { title: "Name" },
            { title: "Position" },
            { title: "Office" },
            { title: "Extn." },
            { title: "Start date" },
            { title: "Salary" }
        ]
    } );
} );
  **/
});


    
  
  
</script>

<body  class="wde-map-page">
  
  

<!-- top navigation w/ WxDE and FHWA logo -->
<div class="navbar navbar-fixed-top fhwa-gradient-color" id="top-nav">
    
</div>

<!-- main top mini navigation menu -->
<div class="navbar navbar-fixed-top nav-top" id="menu-nav">
    
</div>


<!-- 	/////// -->
<!-- 	TOP TOOLBAR -->
<div class="top-toolbar-container" id="top-tools">
 
  <div id="latlong" style="display:inline-block">Lat, Lon: <span id="latValue"></span>, <span id="lngValue"></span></div>
    <div id="stationCode" style="display:inline-block">Station Code: <span id="stationCodeValue"></span></div>

</div>
<!-- 	END OF TOP TOOLBAR -->
<!-- 	/////// -->

<!-- 	MAP CONTAINER -->
<div id="map-container">
   
<div id="dialog-form" >
  <table id="platform-details" class="display" width="100%"><tbody></tbody></table>
  <div style="max-height: 300px;"><table id="obs-data" class="display" width="100%"><caption>Observations</caption><thead><tr><th>Type</th><th>mValue</th><th>mUnit</th><th>eValue</th><th>eUnit</th><th>Time</th></tr></thead><tbody></tbody></table></div>
</div>
  <div id="LayersMenuContainer">
  <ul id="LayersMenu">
    <li><label for="chkRwisLayer">RWIS</label><input type="checkbox" id="chkRwisLayer" /></li>
    <li><label for="chkMobileLayer">Mobile</label><input type="checkbox" id="chkMobileLayer" /></li>
    <li><label for="chkMetaDataLayer">MetaData</label><input type="checkbox" id="chkMetaDataLayer" /></li>
    <li><label for="chkRoadLayer">Roads</label><input type="checkbox" id="chkRoadLayer" /></li>
</ul></div>
    <div id="map_canvas" > </div>
</div>
<!-- 	END OF MAP -->
<!-- 	/////// -->

<!-- 	BUTTOM TOOLBAR -->
<div class="bottom-toolbar-container" id="bottom-tools">
  <div id="layerControlContainer"> <input id="LayersMenuButton" type="button" value="Layers" /><select  id="obstypes"><option value="0">Select an obs type</option></select><input type="radio" name="UNIT" checked="checked" id="metricUnits" /><label for="metricUnits">Metric</label><input type="radio" name="UNIT" id="englishUnits" /><label for="englishUnits">English</label></div>
  <div id="timeUTC"><input type="text" value="" id="datetimepicker"/></div>

</div>
<!-- 	END OF BOTTOM TOOLBAR -->
<!--    /////// -->
<!-- 	FOOTER -->

<div class="footer">
	<div style="float:left; border-right:solid 1px #ccc; border-radius: 0px; padding: 0 10px;">
		<a href="http://www.fhwa.dot.gov/" id="footer-link" target="_blank" title=""><img src="fhwa-footer-image.png" alt="FHWA footer logo"></a>
	</div>
	<div style="float:left; margin-left:10px;">
		<a href="https://wxde.fhwa.dot.gov/privacyPolicy.jsp" title="">Privacy Policy</a> | 
		<a href="http://www.fhwa.dot.gov/foia/" title="">Freedom of Information Act (FOIA)</a> | 
		<a href="http://www.fhwa.dot.gov/accessibility/" title="">Accessibility</a> | 
		<a href="http://www.fhwa.dot.gov/webpolicies/publishschedule.cfm" target="_blank" title="">Web Policies &amp; Notices</a> | 
		<a href="https://www.civilrights.dot.gov/civil-rights-awareness-enforcement/employment-related/affirmative-employment/no-fear-act" target="_blank" title="">No Fear Act</a> | 
		<a href="http://www.oig.dot.gov/Hotline" target="_blank" title="">Report Waste, Fraud and Abuse</a>
		<br>
		<a href="http://www.dot.gov/" target="_blank" title="">U.S. DOT Home</a> | 
		<a href="http://www.usa.gov/" class="exit-link" target="_blank" title="">USA.gov</a> | 
		<a href="http://www.whitehouse.gov/" class="exit-link" target="_blank" title="">WhiteHouse.gov</a>
		<br><br>
		<a href="http://www.fhwa.dot.gov/" target="_blank" title="">Federal Highway Administration</a> | 1200 New Jersey Avenue, SE | Washington, DC 20590 | 202-366-4000
		<br>
		<a href="http://www.fhwa.dot.gov/research/tfhrc/" target="_blank" title="">Turner-Fairbank Highway Research Center</a> | 6300 Georgetown Pike | McLean, VA 22101
	</div>
</div>

<script>L_PREFER_CANVAS = true;</script>
</body></html>